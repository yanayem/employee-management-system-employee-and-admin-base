{% load static %}
<!DOCTYPE html>
<html lang="en" class="light">
<head>
    <meta charset="UTF-8">
    <title>Admin Attendance</title>
    <link rel="stylesheet" href="{% static 'css/theme.css' %}">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Enable Tailwind class-based dark mode
      tailwind.config = { darkMode: "class" };
    </script>
</head>
<body class="bg-gray-100 dark:bg-blue-900 text-gray-800 dark:text-gray-100 transition-colors duration-300">

{% include 'adminsidetopbar.html' %}

<div class="ml-64 mt-16 p-6">
    <h2 class="text-3xl font-bold mb-6">Employee Attendance</h2>

    <!-- Filters -->
    <form method="GET" class="flex flex-col md:flex-row md:items-center md:space-x-4 mb-6">
        <select name="employee_id" class="w-full md:w-1/3 p-3 rounded-lg border dark:bg-blue-700 dark:border-blue-600">
            <option value="">All Employees</option>
            {% for emp in employees %}
                <option value="{{ emp.employee_id }}" {% if employee_id == emp.employee_id %}selected{% endif %}>
                    {{ emp.full_name }} ({{ emp.employee_id }})
                </option>
            {% endfor %}
        </select>

        <input type="date" name="date" value="{{ date_filter }}" 
            class="w-full md:w-1/4 p-3 rounded-lg border dark:bg-blue-700 dark:border-blue-600">

        <button type="submit" class="bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 transition mt-2 md:mt-0">
            Filter
        </button>
    </form>

    <!-- Attendance Table -->
<div class="overflow-x-auto">
    <table class="min-w-full bg-white dark:bg-blue-800 rounded-xl shadow">
        <thead class="bg-gray-200 dark:bg-blue-700 text-gray-800 dark:text-gray-100">
            <tr>
                <th class="py-3 px-4 text-left">Employee</th>
                <th class="py-3 px-4 text-left">ID</th>
                <th class="py-3 px-4 text-left">Date</th>
                <th class="py-3 px-4 text-left">Check In</th>
                <th class="py-3 px-4 text-left">Check Out</th>
                <th class="py-3 px-4 text-left">Status</th>
                <th class="py-3 px-4 text-left">Working Hours</th>
                <th class="py-3 px-4 text-left">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for att in attendances %}
            <tr class="border-b border-gray-200 dark:border-blue-700">
                <td class="py-2 px-4">{{ att.employee.full_name }}</td>
                <td class="py-2 px-4">{{ att.employee.employee_id }}</td>
                <td class="py-2 px-4">{{ att.date }}</td>
                
                <form method="POST" class="flex flex-row items-center space-x-2">
                    {% csrf_token %}
                    <input type="hidden" name="attendance_id" value="{{ att.id }}">
                    
                    <td class="py-2 px-2">
                        <input type="time" name="check_in" value="{{ att.check_in|default_if_none:'' }}" 
                        class="w-full p-1 rounded border dark:bg-blue-700 dark:border-blue-600">
                    </td>
                    <td class="py-2 px-2">
                        <input type="time" name="check_out" value="{{ att.check_out|default_if_none:'' }}" 
                          class="w-full p-1 rounded border dark:bg-blue-700 dark:border-blue-600">
                    </td>
                    <td class="py-2 px-2">
                        <select name="status" class="p-1 rounded border dark:bg-blue-700 dark:border-blue-600">
    <option value="Present" {% if att.status == "Present" %}selected{% endif %}>Present</option>
    <option value="Absent" {% if att.status == "Absent" %}selected{% endif %}>Absent</option>
    <option value="Late" {% if att.status == "Late" %}selected{% endif %}>Late</option>
</select>

                    </td>
                    <td class="py-2 px-4">{{ att.working_hours }}</td>
                    <td class="py-2 px-2">
                        <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded">Update</button>
                    </td>
                </form>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8" class="py-4 text-center text-gray-600 dark:text-gray-300">No records found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

</div>

</body>
</html>
