<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100">

{% include 'adminsidetopbar.html' %}

<div class="ml-64 mt-16 p-6">

<!-- Stats Cards -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-4 p-4">
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
        <h2 class="text-sm font-semibold text-gray-500 dark:text-gray-300">Total Employees</h2>
        <p class="text-3xl font-bold">{{ total_employees }}</p>
    </div>
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
        <h2 class="text-sm font-semibold text-gray-500 dark:text-gray-300">Total Projects</h2>
        <p class="text-3xl font-bold">{{ total_projects }}</p>
    </div>
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
        <h2 class="text-sm font-semibold text-gray-500 dark:text-gray-300">Pending Leaves</h2>
        <p class="text-3xl font-bold">{{ pending_leaves }}</p>
    </div>
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
        <h2 class="text-sm font-semibold text-gray-500 dark:text-gray-300">Today's Attendance</h2>
        <p class="text-3xl font-bold">{{ today_attendance }}</p>
    </div>
</div>

<!-- Charts Section -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-4 p-4">
    <!-- Project Progress -->
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
        <h2 class="text-lg font-semibold mb-2">Project Progress</h2>
        <canvas id="barChart"></canvas>
    </div>

    <!-- Leave Status Pie -->
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow">
        <h2 class="text-lg font-semibold mb-2">Leave Status</h2>
        <canvas id="pieChart"></canvas>
    </div>

    <!-- Monthly Attendance -->
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow md:col-span-2">
        <h2 class="text-lg font-semibold mb-2">Monthly Attendance</h2>
        <canvas id="lineChart"></canvas>
    </div>

    <!-- Employee Performance -->
    <div class="bg-white dark:bg-gray-800 p-6 rounded shadow md:col-span-2">
        <h2 class="text-lg font-semibold mb-2">Top Employee Performance</h2>
        <canvas id="perfChart"></canvas>
    </div>
</div>
</div>

<script>
    // Theme toggle
    const toggle = document.getElementById('theme-toggle');
    toggle.addEventListener('click', () => document.documentElement.classList.toggle('dark'));

    // Bar Chart - Project Progress
    new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: {
            labels: {{ project_labels|safe }},
            datasets: [{
                label: 'Progress %',
                data: {{ project_progress|safe }},
                backgroundColor: 'rgba(59,130,246,0.7)',
                borderColor: 'rgba(59,130,246,1)',
                borderWidth: 1
            }]
        },
        options: { responsive: true, scales: { y: { beginAtZero: true, max:100 } } }
    });

    // Pie Chart - Leave Status
    new Chart(document.getElementById('pieChart'), {
        type: 'pie',
        data: {
            labels: ['Pending', 'Approved', 'Rejected'],
            datasets: [{
                data: [
                    {{ leave_status_dict.Pending }},
                    {{ leave_status_dict.Approved }},
                    {{ leave_status_dict.Rejected }}
                ],
                backgroundColor: ['#facc15','#22c55e','#ef4444'],
            }]
        }
    });

    // Line Chart - Monthly Attendance
    new Chart(document.getElementById('lineChart'), {
        type: 'line',
        data: {
            labels: {{ monthly_labels|safe }},
            datasets: [{
                label: 'Attendance',
                data: {{ monthly_attendance|safe }},
                fill: false,
                borderColor: 'rgba(59,130,246,1)',
                tension: 0.3
            }]
        },
        options: { responsive: true, scales: { y: { beginAtZero:true } } }
    });

    // Performance Chart - Top Employees
    new Chart(document.getElementById('perfChart'), {
        type: 'bar',
        data: {
            labels: {{ employee_names|safe }},
            datasets: [{
                label: 'Performance Score',
                data: {{ performance_scores|safe }},
                backgroundColor: 'rgba(34,197,94,0.7)',
                borderColor: 'rgba(34,197,94,1)',
                borderWidth: 1
            }]
        },
        options: { responsive:true, scales: { y: { beginAtZero:true, max:100 } } }
    });
</script>

</body>
</html>
